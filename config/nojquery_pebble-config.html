<html>
<head>
    <title>colour Pebble App</title>
    <meta name="viewport" content="width=device-width" />
    <style>
        /* Local CSS, try and avoid external dependencies even if results are not as pretty as when using hosted solutions like http://purecss.io/ */
        p {
            font-family:Arial;
            font-size:11pt;
        }

        h1 {
            font-family:Arial;
            font-size:20pt;
        }

        /* Buttons */
        /* using http://www.bestcssbuttongenerator.com/ */
        .save_btn {
            background-color:#44c767;
            -moz-border-radius:28px;
            -webkit-border-radius:28px;
            border-radius:28px;
            border:1px solid #18ab29;
            display:inline-block;
            cursor:pointer;
            color:#ffffff;
            font-family:Arial;
            font-size:17px;
            padding:16px 31px;
            text-decoration:none;
            text-shadow:0px 1px 0px #2f6627;
        }
        .save_btn:hover {
            background-color:#5cbf2a;
        }
        .save_btn:active {
            position:relative;
            top:1px;
        }

        .cancel_btn {
            background-color:#ff0000;
            -moz-border-radius:28px;
            -webkit-border-radius:28px;
            border-radius:28px;
            border:1px solid #ab1934;
            display:inline-block;
            cursor:pointer;
            color:#ffffff;
            font-family:Arial;
            font-size:17px;
            padding:16px 31px;
            text-decoration:none;
            text-shadow:0px 1px 0px #662828;
        }
        .cancel_btn:hover {
            background-color:#bd2a2a;
        }
        .cancel_btn:active {
            position:relative;
            top:1px;
        }

        /* Select, option Drop down */
        /* From http://red-team-design.com/making-html-dropdowns-not-suck/ */
        /*
            B.E.M Naming convention:
            (Block) .custom-dropdown			= The main component
            (Element) .custom-dropdown__select	= Descendant of .custom-dropdown
            (Modifier) .custom-dropdown--*		= Different state of .custom-dropdown
        */

        .custom-dropdown--large {
            font-size: 1.5em;
        }

        .custom-dropdown--small {
            font-size: .7em;
        }

        .custom-dropdown__select{
            font-size: inherit; /* inherit size from .custom-dropdown */
            padding: .5em; /* add some space*/
            margin: 0; /* remove default margins */
        }

        .custom-dropdown__select--white {
            background-color: #fff;
            color: #444;
        }

        .custom-dropdown__select--emerald {
            background-color: #20b390;
            color: #fff;
        }

        .custom-dropdown__select--red {
            background-color: #d53a22;
            color: #fff;
        }

        @supports (pointer-events: none) and
                  ((-webkit-appearance: none) or
                  (-moz-appearance: none) or
                  (appearance: none)) {

            h2+p {
                color: green; /* Demo only */
            }

            .custom-dropdown {
                position: relative;
                display: inline-block;
                vertical-align: middle;
            }

            .custom-dropdown__select {
                padding-right: 2.5em; /* accommodate with the pseudo elements for the dropdown arrow */				
                border: 0;
                border-radius: 3px;
                -webkit-appearance: none;
                -moz-appearance: none;
                appearance: none;
            }

            .custom-dropdown::before,
            .custom-dropdown::after {
                content: "";
                position: absolute;
                pointer-events: none;
            }

            .custom-dropdown::after { /*  Custom dropdown arrow */
                content: "\25BC";
                height: 1em;
                font-size: .625em;
                line-height: 1;
                right: 1.2em;
                top: 50%; margin-top: -.5em;
            }

            .custom-dropdown::before { /*  Custom dropdown arrow cover */
                width: 2em;
                right: 0; top: 0; bottom: 0;
                border-radius: 0 3px 3px 0;
            }

            .custom-dropdown__select[disabled] {
                color: rgba(0,0,0,.3);
            }

            .custom-dropdown.custom-dropdown--disabled::after {
                color: rgba(0,0,0,.1);
            }

            /* White dropdown style */
            .custom-dropdown--white::before {
                background-color: #fff;
                border-left: 1px solid rgba(0,0,0,.1);
            }

            .custom-dropdown--white::after {
                color: rgba(0,0,0,.9);
            }

            /* Emerald dropdown style */
            .custom-dropdown--emerald::before {
                background-color: #1aa181;
            }

            .custom-dropdown--emerald::after {
                color: rgba(0,0,0,.4);
            }


            /* Red dropdown style */
            .custom-dropdown--red::before {
                background-color: #d53a22;
            }

            .custom-dropdown--red::after {
                color: rgba(0,0,0,.4);
            }

            /* FF only temporary & ugly fixes */
            /* the "appearance: none" applied on select still shows a dropdown arrow on Firefox */
            /* https://bugzilla.mozilla.org/show_bug.cgi?id=649849 */
            @-moz-document url-prefix() {
                .custom-dropdown__select 						 { padding-right: .9em }
                .custom-dropdown--large .custom-dropdown__select { padding-right: 1.3em }
                .custom-dropdown--small .custom-dropdown__select { padding-right: .5em }
            }

        }


        .custom-dropdown {
            margin: 10px;
            display: inline-block;
        }

    </style>
</head>

<body>
    <h1>Color Watch Face config:</h1>

    <!--
    <p>
        <button id="save_button" class="save_btn">Save</button>
        <button id="cancel_button" class="cancel_btn">Cancel</button>
    </p>
    -->

    <p>Time and Date color:
        <!--
            TODO use colors for background in selection option? May need to do this in javascript only
        -->
        <span class="custom-dropdown custom-dropdown--white custom-dropdown--large">
        <select id="time_color" name="time_color" class="custom-dropdown__select custom-dropdown__select--white">
            <option value="AAFFAA">MintGreen</option>
            <option value="5500FF">ElectricUltramarine</option>
            <option value="FF0055">Folly</option>
            <option value="55FFFF">ElectricBlue</option>
            <option value="555500">ArmyGreen</option>
            <option value="0000AA">DukeBlue</option>
            <option value="5555FF">VeryLightBlue</option>
            <option value="00AAAA">TiffanyBlue</option>
            <option value="55AAFF">PictonBlue</option>
            <option value="5500AA">Indigo</option>
            <option value="AAFF00">SpringBud</option>
            <option value="55FF00">BrightGreen</option>
            <option value="000055">OxfordBlue</option>
            <option value="55AAAA">CadetBlue</option>
            <option value="AA5555">RoseVale</option>
            <option value="FF00AA">FashionMagenta</option>
            <option value="FFAAAA">Melon</option>
            <option value="AA0055">JazzberryJam</option>
            <option value="AA55AA">Purpureus</option>
            <option value="550055">ImperialPurple</option>
            <option value="005500">DarkGreen</option>
            <option value="0000FF">Blue</option>
            <option value="5555AA">Liberty</option>
            <option value="55AA00">KellyGreen</option>
            <option value="55AA55">MayGreen</option>
            <option value="AA00FF">VividViolet</option>
            <option value="FFAA55">Rajah</option>
            <option value="FF55AA">BrilliantRose</option>
            <option value="AAAAAA">LightGray</option>
            <option value="00AAFF">VividCerulean</option>
            <option value="550000">BulgarianRose</option>
            <option value="00FF00">Green</option>
            <option value="AA5500">WindsorTan</option>
            <option value="00AA55">JaegerGreen</option>
            <option value="555555">DarkGray</option>
            <option value="FF5500">Orange</option>
            <option value="0055FF">BlueMoon</option>
            <option value="000000">Black</option>
            <option value="00FFFF">Cyan</option>
            <option value="AA0000">DarkCandyAppleRed</option>
            <option value="AAAA00">Limerick</option>
            <option value="0055AA">CobaltBlue</option>
            <option value="FFFFAA">PastelYellow</option>
            <option value="FF55FF">ShockingPink</option>
            <option value="55FF55">ScreaminGreen</option>
            <option value="FF0000">Red</option>
            <option value="FFAA00">ChromeYellow</option>
            <option value="AA55FF">LavenderIndigo</option>
            <option value="AAFF55">Inchworm</option>
            <option value="00FF55">Malachite</option>
            <option value="55FFAA">MediumAquamarine</option>
            <option value="FFFF00">Yellow</option>
            <option value="FF00FF">Magenta</option>
            <option value="AAFFFF">Celeste</option>
            <option value="FFAAFF">RichBrilliantLavender</option>
            <option value="AAAAFF">BabyBlueEyes</option>
            <option value="005555">MidnightGreen</option>
            <option value="AA00AA">Purple</option>
            <option value="FFFFFF">White</option>
            <option value="00FFAA">MediumSpringGreen</option>
            <option value="FFFF55">Icterine</option>
            <option value="FF5555">SunsetOrange</option>
            <option value="AAAA55">Brass</option>
            <option value="00AA00">IslamicGreen</option>
        </select>
        </span>
    </p>

    <!--
        <label>Vibrate on Bluetooth disconnect</label></td><td><input type="checkbox" name="vibrate_disconnect" id="vibrate_disconnect"/>
    -->
    <p>
        <label>Vibrate on Bluetooth disconnect:</label>
        <select id="vibrate_disconnect" name="vibrate_disconnect">
            <option value="off">Off</option>
            <option value="on">On</option>
        </select>
    </p>


    <p>
        <button id="save_button" class="save_btn">Save</button>
        <button id="cancel_button" class="cancel_btn">Cancel</button>
    </p>

</body>
</html>


<script>
    // Local javascript, try and avoid external dependencies even if results are not as complete as other options such as https://jquery.com/, http://zeptojs.com/
    // http://youmightnotneedjquery.com/

    // get URL query variables
    function getQueryParam(variable, defaultValue) {
        // Find all URL parameters
        var query = location.search.substring(1);
        var vars = query.split('&');
        for (var i = 0; i < vars.length; i++) {
            var pair = vars[i].split('=');

            // If the query variable parameter is found, decode it to use and return it for use
            if (pair[0] === variable) {
                return decodeURIComponent(pair[1]);
            }
        }
        return defaultValue || false;
    }

    //Setup to allow easy adding more options later
    function saveOptions() {
        var v = document.getElementById("vibrate_disconnect");
        var e = document.getElementById("time_color");
        var hex_color_str = e.options[e.selectedIndex].value; // or text for display
        var options = {
            'color': hex_color_str,
            'vibrate_disconnect': v.value
        }
        return options;
    };



     document.getElementById("cancel_button").addEventListener('click',
        function () {
            console.log("Cancel");

            // Set the return URL depending on the runtime environment (emulator or Pebble Phone App)
            var return_to = getQueryParam('return_to', 'pebblejs://close#cancel');
            document.location.href = return_to;
        }
    , false);

    // TODO do this for all items with the same id (e.g. allow two save buttons, top and bottom of page
     document.getElementById("save_button").addEventListener('click',
        function () {
            console.log("Submit");
            var options = saveOptions();

            // Set the return URL depending on the runtime environment (emulator or Pebble Phone App)
            var return_to = getQueryParam('return_to', 'pebblejs://close#');
            document.location.href = return_to + encodeURIComponent(JSON.stringify(options));
        }
    , false);

    // TODO on ready...
    //document.getElementById("vibrate_disconnect").selectedIndex = 1; // works
    document.getElementById('vibrate_disconnect').value = getQueryParam('vibrate_disconnect', 'off');
    var time_color = getQueryParam('color', 'FFFFAA');
    document.getElementById('time_color').value = getQueryParam('time_color', time_color);

</script>
